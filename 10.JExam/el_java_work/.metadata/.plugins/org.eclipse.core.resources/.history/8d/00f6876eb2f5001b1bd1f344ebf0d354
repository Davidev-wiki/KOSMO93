package a.b.c.ch9.kckmem;

import java.sql.Connection;
import java.sql.PreparedStatement;
import java.sql.ResultSet;
import java.util.ArrayList;

import a.b.c.ch9.kck.vo.KckMemberVO;
import a.b.c.common.KckConnProperty;

public class KckMember {

	// 쿼리문
	public static final String KMEM_SELECT = "SELECT * FROM KCK_MEMBER";
	// 멤버변수

	// 함수
	public ArrayList<KckMemberVO> kmemSelectALL() {

		Connection conn = null;
//		Statement stmt = null;
		PreparedStatement pstmt = null;
		ResultSet rsRs = null;

		ArrayList<KckMemberVO> aList = null;

		try {

			conn = KckConnProperty.getConnection();
//			stmt = conn.createStatement();
			pstmt = conn.prepareStatement(KckMember.KMEM_SELECT);
//			rsRs = stmt.executeQuery(Ex_Test02_1.T3_SELECT);
			rsRs = pstmt.executeQuery();

			if (rsRs != null) {

				aList = new ArrayList<KckMemberVO>();

				while (rsRs.next()) {

					KckMemberVO kvo = new KckMemberVO();
					kvo.setHNUM(rsRs.getString("HNUM"));
					kvo.setHNAME(rsRs.getString("HNAME"));
					kvo.setHID(rsRs.getString("HID"));
					kvo.setHPW(rsRs.getString("HPW"));
					kvo.setHBIRTH(rsRs.getString("HBIRTH"));
					kvo.setHGENDER(rsRs.getString("HGENDER"));
					kvo.setHTEL(rsRs.getString("HTEL"));
					kvo.setHHP(rsRs.getString("HHP"));
					kvo.setHEMAIL(rsRs.getString("HEMAIL"));
					kvo.setHADDR(rsRs.getString("HADDR"));
					kvo.setHHOBBY(rsRs.getString("HHOBBY"));
					kvo.setHPHOTO(rsRs.getString("HPHOTO"));
					kvo.setHSKILL(rsRs.getString("HSKILL"));
					kvo.setHJOB(rsRs.getString("HJOB"));
					kvo.setDELETEYN(rsRs.getString("DELETEYN"));
					kvo.setINSERTDATE(rsRs.getString("INSERTDATE"));
					kvo.setUPDATEDATE(rsRs.getString("UPDATEDATE"));

					aList.add(kvo);
				}
			}
		} catch (Exception e) {
			System.out.println("t3Select() 함수에서 디비연결 또는 쿼리에서 문제가 생겼슴 >>> : " + e.getMessage());
		}

		return aList;
	}

	public static void main(String[] args) {
		// TODO Auto-generated method stub

		KckMember kckm = new KckMember();

		ArrayList<KckMemberVO> aList = kckm.kmemSelectALL();

		if (aList != null && aList.size() > 0) {
			for (int i = 0; i < aList.size(); i++) {

				KckMemberVO kvo = aList.get(i);

				System.out.print(kvo.getHNUM() + " : ");
				System.out.print(kvo.getHNAME() + " : ");
				System.out.print(kvo.getHID() + " : ");
				System.out.print(kvo.getHPW() + " : ");
				System.out.print(kvo.getHBIRTH() + " : ");
				System.out.print(kvo.getHGENDER() + " : ");
				System.out.print(kvo.getHTEL() + " : ");
				System.out.print(kvo.getHHP() + " : ");
				System.out.print(kvo.getHEMAIL() + " : ");
				System.out.print(kvo.getHADDR() + " : ");
				System.out.print(kvo.getHHOBBY() + " : ");
				System.out.print(kvo.getHPHOTO() + " : ");
				System.out.print(kvo.getHSKILL() + " : ");
				System.out.print(kvo.getHJOB() + " : ");
				System.out.print(kvo.getDELETEYN() + " : ");
				System.out.print(kvo.getINSERTDATE() + " : ");
				System.out.println(kvo.getUPDATEDATE());
			}
		} else {
			System.out.println("aList 에 데이터가 없네요 >>> : " + aList);
		}
	}
}
